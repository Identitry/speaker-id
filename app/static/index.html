<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speaker-ID - Voice Recognition System</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                    <line x1="12" y1="19" x2="12" y2="23"></line>
                    <line x1="8" y1="23" x2="16" y2="23"></line>
                </svg>
                <h1>Speaker-ID</h1>
            </div>
            <div class="status-indicator">
                <span class="status-dot" id="statusDot"></span>
                <span class="status-text" id="statusText">Connecting...</span>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab-button active" data-tab="identify">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                Identify
            </button>
            <button class="tab-button" data-tab="enroll">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
                    <circle cx="8.5" cy="7" r="4"></circle>
                    <line x1="20" y1="8" x2="20" y2="14"></line>
                    <line x1="23" y1="11" x2="17" y2="11"></line>
                </svg>
                Enroll
            </button>
            <button class="tab-button" data-tab="manage">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 00-3-3.87m-4-12a4 4 0 010 7.75"></path>
                </svg>
                Manage
            </button>
            <button class="tab-button" data-tab="settings">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M12 1v6m0 6v6m5.196-15.196l-4.242 4.242m-5.908 5.908l-4.242 4.242m18.384 0l-4.242-4.242m-5.908-5.908l-4.242-4.242"></path>
                </svg>
                Settings
            </button>
            <button class="tab-button" data-tab="api">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
                API
            </button>
        </nav>

        <!-- Tab Content -->
        <main class="content">
            <!-- Identify Tab -->
            <div id="identify" class="tab-content active">
                <div class="tab-header">
                    <h2>Identify Speaker</h2>
                    <p>Upload an audio file or record your voice to identify the speaker</p>
                </div>

                <div class="input-methods">
                    <div class="input-method">
                        <h3>
                            <svg class="method-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                            </svg>
                            Record Audio
                        </h3>
                        <div class="recorder">
                            <button id="identifyRecordBtn" class="record-button">
                                <svg class="record-icon" viewBox="0 0 24 24" fill="currentColor">
                                    <circle cx="12" cy="12" r="10"></circle>
                                </svg>
                                <span>Start Recording</span>
                            </button>
                            <div id="identifyRecordingStatus" class="recording-status"></div>
                            <audio id="identifyAudioPlayback" controls class="audio-playback" style="display: none;"></audio>
                        </div>
                    </div>

                    <div class="divider">
                        <span>OR</span>
                    </div>

                    <div class="input-method">
                        <h3>
                            <svg class="method-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m14-7l-5-5-5 5m5-5v12"></path>
                            </svg>
                            Upload File
                        </h3>
                        <div class="file-upload">
                            <input type="file" id="identifyFileInput" accept="audio/*,.wav,.mp3,.flac" hidden>
                            <label for="identifyFileInput" class="file-upload-label">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m14-7l-5-5-5 5m5-5v12"></path>
                                </svg>
                                <span>Choose Audio File</span>
                            </label>
                            <div id="identifyFileName" class="file-name"></div>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label for="identifyThreshold">
                            Confidence Threshold: <span id="thresholdValue">0.82</span>
                            <span class="info-tooltip" title="Higher values (0.85-0.95) = stricter matching, fewer false positives. Lower values (0.70-0.80) = more lenient, fewer false negatives.">â“˜</span>
                        </label>
                        <input type="range" id="identifyThreshold" min="0.5" max="0.99" step="0.01" value="0.82" class="slider">
                        <div class="threshold-labels">
                            <span>Lenient (0.50)</span>
                            <span>Balanced</span>
                            <span>Strict (0.99)</span>
                        </div>
                    </div>

                    <button id="identifyBtn" class="primary-button" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        Identify Speaker
                    </button>
                </div>

                <div id="identifyResult" class="result-panel" style="display: none;"></div>
            </div>

            <!-- Enroll Tab -->
            <div id="enroll" class="tab-content">
                <div class="tab-header">
                    <h2>Enroll Speaker</h2>
                    <p>Add a new speaker to the system. For best results, provide 3-5 voice samples.</p>
                </div>

                <div class="form-group">
                    <label for="enrollName">
                        Speaker Name
                        <span class="required">*</span>
                    </label>
                    <input type="text" id="enrollName" placeholder="Enter speaker name..." class="text-input">
                    <small>Use a unique name for each person (e.g., "Alice", "Bob")</small>
                </div>

                <div class="input-methods">
                    <div class="input-method">
                        <h3>
                            <svg class="method-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                            </svg>
                            Record Audio
                        </h3>
                        <div class="recorder">
                            <button id="enrollRecordBtn" class="record-button">
                                <svg class="record-icon" viewBox="0 0 24 24" fill="currentColor">
                                    <circle cx="12" cy="12" r="10"></circle>
                                </svg>
                                <span>Start Recording</span>
                            </button>
                            <div id="enrollRecordingStatus" class="recording-status"></div>
                            <audio id="enrollAudioPlayback" controls class="audio-playback" style="display: none;"></audio>
                        </div>
                    </div>

                    <div class="divider">
                        <span>OR</span>
                    </div>

                    <div class="input-method">
                        <h3>
                            <svg class="method-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m14-7l-5-5-5 5m5-5v12"></path>
                            </svg>
                            Upload File
                        </h3>
                        <div class="file-upload">
                            <input type="file" id="enrollFileInput" accept="audio/*,.wav,.mp3,.flac" hidden>
                            <label for="enrollFileInput" class="file-upload-label">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m14-7l-5-5-5 5m5-5v12"></path>
                                </svg>
                                <span>Choose Audio File</span>
                            </label>
                            <div id="enrollFileName" class="file-name"></div>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button id="enrollBtn" class="primary-button" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                        Enroll Speaker
                    </button>
                </div>

                <div id="enrollResult" class="result-panel" style="display: none;"></div>
            </div>

            <!-- Manage Tab -->
            <div id="manage" class="tab-content">
                <div class="tab-header">
                    <h2>Manage Speakers</h2>
                    <p>View and manage enrolled speakers in the system</p>
                </div>

                <div class="manage-controls">
                    <button id="refreshSpeakers" class="secondary-button">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M1 4v6h6M23 20v-6h-6"></path>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                        </svg>
                        Refresh
                    </button>
                    <button id="deleteSelected" class="danger-button" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                        Delete Selected
                    </button>
                </div>

                <div id="speakersList" class="speakers-list">
                    <div class="loading">Loading speakers...</div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
                <div class="tab-header">
                    <h2>Settings & Configuration</h2>
                    <p>System configuration and adjustable parameters</p>
                </div>

                <div class="settings-sections">
                    <div class="settings-section">
                        <h3>System Information</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Status</span>
                                <span class="info-value" id="settingsStatus">â€”</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Model</span>
                                <span class="info-value" id="settingsModel">â€”</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Embedding Dimension</span>
                                <span class="info-value" id="settingsEmbeddingDim">â€”</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Sample Rate</span>
                                <span class="info-value" id="settingsSampleRate">â€”</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Default Threshold</span>
                                <span class="info-value" id="settingsThreshold">â€”</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Version</span>
                                <span class="info-value" id="settingsVersion">â€”</span>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Database</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Enrolled Speakers</span>
                                <span class="info-value" id="settingsSpeakerCount">â€”</span>
                            </div>
                        </div>
                        <div class="settings-actions">
                            <button id="rebuildCentroids" class="secondary-button">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M1 4v6h6M23 20v-6h-6"></path>
                                    <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                                </svg>
                                Rebuild Centroids
                            </button>
                        </div>
                    </div>

                    <div class="settings-section danger-zone">
                        <h3>Danger Zone</h3>
                        <p class="warning-text">These actions cannot be undone</p>
                        <button id="resetDatabase" class="danger-button">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path>
                            </svg>
                            Reset All Data
                        </button>
                    </div>
                </div>
            </div>

            <!-- API Tab -->
            <div id="api" class="tab-content">
                <div class="tab-header">
                    <h2>API Documentation</h2>
                    <p>Integration endpoints and API resources</p>
                </div>

                <div class="api-sections">
                    <div class="api-section">
                        <h3>Interactive Documentation</h3>
                        <div class="api-links">
                            <a href="/docs" target="_blank" class="api-link">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                </svg>
                                <div>
                                    <strong>Swagger UI</strong>
                                    <small>Interactive API testing interface</small>
                                </div>
                            </a>
                            <a href="/redoc" target="_blank" class="api-link">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                </svg>
                                <div>
                                    <strong>ReDoc</strong>
                                    <small>Clean, readable documentation</small>
                                </div>
                            </a>
                        </div>
                    </div>

                    <div class="api-section">
                        <h3>Core Endpoints</h3>
                        <div class="endpoint-list">
                            <div class="endpoint">
                                <span class="method method-post">POST</span>
                                <code>/api/identify</code>
                                <span class="endpoint-desc">Identify speaker from audio</span>
                            </div>
                            <div class="endpoint">
                                <span class="method method-post">POST</span>
                                <code>/api/enroll</code>
                                <span class="endpoint-desc">Enroll new speaker</span>
                            </div>
                            <div class="endpoint">
                                <span class="method method-get">GET</span>
                                <code>/api/profiles</code>
                                <span class="endpoint-desc">List enrolled speakers</span>
                            </div>
                            <div class="endpoint">
                                <span class="method method-post">POST</span>
                                <code>/api/reset</code>
                                <span class="endpoint-desc">Delete speaker or reset all</span>
                            </div>
                            <div class="endpoint">
                                <span class="method method-post">POST</span>
                                <code>/api/rebuild_centroids</code>
                                <span class="endpoint-desc">Rebuild speaker centroids</span>
                            </div>
                            <div class="endpoint">
                                <span class="method method-get">GET</span>
                                <code>/health</code>
                                <span class="endpoint-desc">Health check</span>
                            </div>
                            <div class="endpoint">
                                <span class="method method-get">GET</span>
                                <code>/metrics</code>
                                <span class="endpoint-desc">Prometheus metrics</span>
                            </div>
                        </div>
                    </div>

                    <div class="api-section">
                        <h3>Example Usage</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>cURL - Identify Speaker</span>
                                <button class="copy-button" data-copy="curl-identify">Copy</button>
                            </div>
                            <pre id="curl-identify"><code>curl -X POST "http://localhost:8080/api/identify?threshold=0.82" \
  -F "file=@voice_sample.wav"</code></pre>
                        </div>

                        <div class="code-example">
                            <div class="code-header">
                                <span>cURL - Enroll Speaker</span>
                                <button class="copy-button" data-copy="curl-enroll">Copy</button>
                            </div>
                            <pre id="curl-enroll"><code>curl -X POST "http://localhost:8080/api/enroll?name=Alice" \
  -F "file=@alice_voice.wav"</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>Speaker-ID - Voice Recognition System</p>
            <p class="footer-links">
                <a href="https://github.com/Identitry/speaker-id" target="_blank">GitHub</a>
                <span>â€¢</span>
                <a href="/docs" target="_blank">API Docs</a>
                <span>â€¢</span>
                <a href="https://github.com/Identitry/speaker-id/blob/main/docs/ha-integration.md" target="_blank">Home Assistant</a>
            </p>
        </footer>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
